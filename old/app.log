2025-01-03 15:40:37 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:40:37 - INFO - Testing info log!
2025-01-03 15:40:37 - WARNING - Testing warning log!
2025-01-03 15:40:37 - ERROR - Testing error log!
2025-01-03 15:40:37 - CRITICAL - Testing critical log!
2025-01-03 15:40:37 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:40:37 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:40:37 - INFO - Scheduler started
2025-01-03 15:40:37 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 15:40:37 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 15:40:37 - INFO -  * Restarting with stat
2025-01-03 15:40:40 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:40:40 - INFO - Testing info log!
2025-01-03 15:40:40 - WARNING - Testing warning log!
2025-01-03 15:40:40 - ERROR - Testing error log!
2025-01-03 15:40:40 - CRITICAL - Testing critical log!
2025-01-03 15:40:41 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:40:41 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:40:41 - INFO - Scheduler started
2025-01-03 15:40:41 - WARNING -  * Debugger is active!
2025-01-03 15:40:41 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 15:41:07 - INFO - Running job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:41:07 -03)" (scheduled at 2025-01-03 15:41:07.457949-03:00)
2025-01-03 15:41:07 - INFO - Job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:41:37 -03)" executed successfully
2025-01-03 15:41:11 - INFO - Running job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:41:11 -03)" (scheduled at 2025-01-03 15:41:11.022460-03:00)
2025-01-03 15:41:11 - INFO - Job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:41:41 -03)" executed successfully
2025-01-03 15:41:37 - INFO - Running job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:42:07 -03)" (scheduled at 2025-01-03 15:41:37.457949-03:00)
2025-01-03 15:41:37 - INFO - Job "DataService.disable_inactive_users (trigger: interval[0:00:30], next run at: 2025-01-03 15:42:07 -03)" executed successfully
2025-01-03 15:45:34 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:45:34 - INFO - Testing info log!
2025-01-03 15:45:34 - WARNING - Testing warning log!
2025-01-03 15:45:34 - ERROR - Testing error log!
2025-01-03 15:45:34 - CRITICAL - Testing critical log!
2025-01-03 15:45:34 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:45:34 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:45:34 - INFO - Scheduler started
2025-01-03 15:45:34 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 15:45:34 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 15:45:34 - INFO -  * Restarting with stat
2025-01-03 15:45:38 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:45:38 - INFO - Testing info log!
2025-01-03 15:45:38 - WARNING - Testing warning log!
2025-01-03 15:45:38 - ERROR - Testing error log!
2025-01-03 15:45:38 - CRITICAL - Testing critical log!
2025-01-03 15:45:38 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:45:38 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:45:38 - INFO - Scheduler started
2025-01-03 15:45:38 - WARNING -  * Debugger is active!
2025-01-03 15:45:38 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 15:58:00 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:58:00 - INFO - Testing info log!
2025-01-03 15:58:00 - WARNING - Testing warning log!
2025-01-03 15:58:00 - ERROR - Testing error log!
2025-01-03 15:58:00 - CRITICAL - Testing critical log!
2025-01-03 15:58:01 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:58:01 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:58:01 - INFO - Scheduler started
2025-01-03 15:58:01 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 15:58:01 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 15:58:01 - INFO -  * Restarting with stat
2025-01-03 15:58:04 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:58:04 - INFO - Testing info log!
2025-01-03 15:58:04 - WARNING - Testing warning log!
2025-01-03 15:58:04 - ERROR - Testing error log!
2025-01-03 15:58:04 - CRITICAL - Testing critical log!
2025-01-03 15:58:04 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:58:04 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:58:04 - INFO - Scheduler started
2025-01-03 15:58:05 - WARNING -  * Debugger is active!
2025-01-03 15:58:05 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 15:58:25 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:58:25 - INFO - Testing info log!
2025-01-03 15:58:25 - WARNING - Testing warning log!
2025-01-03 15:58:25 - ERROR - Testing error log!
2025-01-03 15:58:25 - CRITICAL - Testing critical log!
2025-01-03 15:58:25 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:58:25 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:58:25 - INFO - Scheduler started
2025-01-03 15:58:25 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 15:58:25 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 15:58:25 - INFO -  * Restarting with stat
2025-01-03 15:58:29 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:58:29 - INFO - Testing info log!
2025-01-03 15:58:29 - WARNING - Testing warning log!
2025-01-03 15:58:29 - ERROR - Testing error log!
2025-01-03 15:58:29 - CRITICAL - Testing critical log!
2025-01-03 15:58:29 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:58:29 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:58:29 - INFO - Scheduler started
2025-01-03 15:58:29 - WARNING -  * Debugger is active!
2025-01-03 15:58:29 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 15:58:47 - INFO -  * Detected change in 'c:\\Users\\lipea\\Desktop\\ProtoDrop\\src\\server\\log_setup.py', reloading
2025-01-03 15:58:47 - INFO -  * Restarting with stat
2025-01-03 15:59:09 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:59:09 - INFO - Testing info log!
2025-01-03 15:59:09 - WARNING - Testing warning log!
2025-01-03 15:59:09 - ERROR - Testing error log!
2025-01-03 15:59:09 - CRITICAL - Testing critical log!
2025-01-03 15:59:09 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:59:09 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:59:09 - INFO - Scheduler started
2025-01-03 15:59:09 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 15:59:09 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 15:59:09 - INFO -  * Restarting with stat
2025-01-03 15:59:13 - WARNING - Error configuring log system: module 'logging' has no attribute 'config'
2025-01-03 15:59:13 - INFO - Testing info log!
2025-01-03 15:59:13 - WARNING - Testing warning log!
2025-01-03 15:59:13 - ERROR - Testing error log!
2025-01-03 15:59:13 - CRITICAL - Testing critical log!
2025-01-03 15:59:13 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 15:59:13 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 15:59:13 - INFO - Scheduler started
2025-01-03 15:59:13 - WARNING -  * Debugger is active!
2025-01-03 15:59:13 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 15:59:21 - INFO -  * Detected change in 'c:\\Users\\lipea\\Desktop\\ProtoDrop\\src\\server\\log_setup.py', reloading
2025-01-03 15:59:22 - INFO -  * Restarting with stat
2025-01-03 16:07:24 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 16:07:24 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 16:07:24 - INFO - Scheduler started
2025-01-03 16:07:24 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 16:07:24 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 16:07:24 - INFO -  * Restarting with stat
2025-01-03 16:07:28 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 16:07:28 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 16:07:28 - INFO - Scheduler started
2025-01-03 16:07:28 - WARNING -  * Debugger is active!
2025-01-03 16:07:28 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 16:36:27 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 16:36:27 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 16:36:27 - INFO - Scheduler started
2025-01-03 16:36:27 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-01-03 16:36:27 - INFO - [33mPress CTRL+C to quit[0m
2025-01-03 16:36:27 - INFO -  * Restarting with stat
2025-01-03 16:36:32 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-01-03 16:36:32 - INFO - Added job "DataService.disable_inactive_users" to job store "default"
2025-01-03 16:36:32 - INFO - Scheduler started
2025-01-03 16:36:32 - WARNING -  * Debugger is active!
2025-01-03 16:36:32 - INFO -  * Debugger PIN: 105-476-008
2025-01-03 17:53:17 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:53:42 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:53:58 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:54:25 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:55:15 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:55:21 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:55:39 - ERROR - Environment variable DB_USER is not set.
2025-01-03 17:56:33 - ERROR - Environment variable DB_USER is not set.
2025-01-03 18:47:59 - INFO - Database connection test passed.
2025-01-03 18:51:26 - INFO - Database connection test passed.
2025-01-03 18:52:06 - INFO - Database connection test passed.
2025-01-03 18:53:30 - INFO - Database connection test passed.
2025-01-03 18:54:50 - ERROR - Database connection test failed: 'utf-8' codec can't decode byte 0xe3 in position 94: invalid continuation byte
2025-01-03 18:55:55 - ERROR - Database connection test failed: 'utf-8' codec can't decode byte 0xe3 in position 94: invalid continuation byte
2025-01-03 19:02:34 - ERROR - Database connection test failed: 'utf-8' codec can't decode byte 0xe3 in position 94: invalid continuation byte
2025-01-03 19:07:49 - ERROR - Database connection test failed: 'utf-8' codec can't decode byte 0xe3 in position 94: invalid continuation byte
2025-01-03 19:07:56 - INFO - Database connection test passed.
2025-01-03 19:34:04 - INFO - Database connection test passed.
2025-01-03 19:34:04 - INFO - Dropping database protodropdb...
2025-01-03 19:34:05 - ERROR - Error executing query: Composed([SQL('DROP DATABASE IF EXISTS '), Identifier('protodropdb')]). Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:34:05 - INFO - Creating database protodropdb...
2025-01-03 19:34:05 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:34:05 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:34:05 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:35:06 - INFO - Database connection test passed.
2025-01-03 19:35:06 - INFO - Dropping database protodropdb...
2025-01-03 19:35:06 - ERROR - Error executing query: Composed([SQL('DROP DATABASE IF EXISTS '), Identifier('protodropdb')]). Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:35:06 - INFO - Creating database protodropdb...
2025-01-03 19:35:06 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:35:06 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:35:07 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:41:06 - INFO - Database connection test passed.
2025-01-03 19:41:06 - INFO - Dropping database protodropdb...
2025-01-03 19:41:06 - ERROR - Error executing query: Composed([SQL('DROP DATABASE IF EXISTS '), Identifier('protodropdb')]). Details: invalid dsn: invalid connection option "autocommit"

2025-01-03 19:41:06 - INFO - Creating database protodropdb...
2025-01-03 19:41:06 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: invalid dsn: invalid connection option "autocommit"

2025-01-03 19:41:06 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:41:06 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:45:10 - INFO - Dropping database protodropdb...
2025-01-03 19:45:10 - ERROR - Error executing query: Composed([SQL('DROP DATABASE IF EXISTS '), Identifier('protodropdb')]). Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:45:10 - INFO - Creating database protodropdb...
2025-01-03 19:45:10 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: invalid dsn: invalid connection option "autocommit"

2025-01-03 19:45:10 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:45:11 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:54:07 - INFO - Dropping database protodropdb...
2025-01-03 19:54:07 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:54:07 - INFO - Creating database protodropdb...
2025-01-03 19:54:07 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: invalid dsn: invalid connection option "autocommit"

2025-01-03 19:54:07 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:54:07 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:55:02 - INFO - Dropping database protodropdb...
2025-01-03 19:55:03 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:55:03 - INFO - Creating database protodropdb...
2025-01-03 19:55:03 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:55:03 - INFO - Database protodropdb recreated successfully.
2025-01-03 19:55:03 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 19:57:21 - INFO - Dropping database protodropdb...
2025-01-03 19:57:21 - ERROR - Error recreating the database protodropdb: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 19:57:21 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 20:03:41 - INFO - Dropping database protodropdb...
2025-01-03 20:03:41 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:03:41 - INFO - Creating database protodropdb...
2025-01-03 20:03:41 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:03:41 - INFO - Database protodropdb recreated successfully.
2025-01-03 20:03:41 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 20:06:13 - INFO - Dropping database protodropdb...
2025-01-03 20:06:13 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:06:13 - INFO - Creating database protodropdb...
2025-01-03 20:06:13 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:06:13 - INFO - Database protodropdb recreated successfully.
2025-01-03 20:06:13 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 20:06:54 - INFO - Dropping database protodropdb...
2025-01-03 20:06:54 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:06:54 - INFO - Creating database protodropdb...
2025-01-03 20:06:54 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:06:54 - INFO - Database protodropdb recreated successfully.
2025-01-03 20:08:39 - INFO - Dropping database protodropdb...
2025-01-03 20:08:39 - ERROR - Error executing query: DROP DATABASE IF EXISTS protodropdb. Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:08:39 - INFO - Creating database protodropdb...
2025-01-03 20:08:39 - ERROR - Error executing query: CREATE DATABASE protodropdb. Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:08:39 - INFO - Database protodropdb recreated successfully.
2025-01-03 20:09:40 - INFO - Database connection test passed.
2025-01-03 20:09:40 - ERROR - Error executing query: Composed([SQL('DROP DATABASE '), Identifier('protodropdb')]). Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:09:40 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:09:40 - INFO - Database protodropdb recreated.
2025-01-03 20:09:40 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 20:10:21 - INFO - Database connection test passed.
2025-01-03 20:10:21 - ERROR - Error executing query: Composed([SQL('DROP DATABASE '), Identifier('protodropdb')]). Details: ERRO:  DROP DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:10:21 - ERROR - Error executing query: Composed([SQL('CREATE DATABASE '), Identifier('protodropdb')]). Details: ERRO:  CREATE DATABASE não pode ser executado dentro de um bloco de transação

2025-01-03 20:10:21 - INFO - Database protodropdb recreated.
2025-01-03 20:10:21 - ERROR - Error executing query: SQL("-- Funcs\nCREATE OR REPLACE FUNCTION prevent_id_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.id IS DISTINCT FROM OLD.id THEN\n        RAISE EXCEPTION 'Cannot update the id column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION prevent_creation_date_update()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.creation_date IS DISTINCT FROM OLD.creation_date THEN\n        RAISE EXCEPTION 'Cannot update the creation_date column';\n    END IF;\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE OR REPLACE FUNCTION set_update_date()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.update_date := NOW();\n    RETURN NEW;           \nEND;\n$$ LANGUAGE plpgsql;\n\n\n-- Creating table users\nCREATE TABLE users (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(50) NOT NULL,\n    city VARCHAR(100) NOT NULL,\n    region VARCHAR(100) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_users\nBEFORE UPDATE ON users\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table accesses\nCREATE TABLE accesses (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_accesses\nBEFORE UPDATE ON accesses\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table videos\nCREATE TABLE videos (\n    id SERIAL PRIMARY KEY,\n    tag VARCHAR(100) NOT NULL,\n    url VARCHAR(500) NOT NULL,\n    title VARCHAR(255) NOT NULL,\n    duration INT NOT NULL,\n    view_count INT NOT NULL,\n    channel_tag VARCHAR(100) NOT NULL,\n    channel_url VARCHAR(500) NOT NULL,\n    channel_name VARCHAR(255) NOT NULL,\n    thumbnail_url VARCHAR(500) NOT NULL,\n    channel_is_verified BOOLEAN NOT NULL,\n    access_count INT DEFAULT 1,\n    is_active BOOLEAN DEFAULT TRUE,\n    last_heartbeat TIMESTAMP DEFAULT CURRENT_TIMESTAMP, \n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TRIGGER prevent_id_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\nCREATE TRIGGER set_new_update_date_trigger_videos\nBEFORE UPDATE ON videos\nFOR EACH ROW\nEXECUTE FUNCTION set_update_date();\n\n\n-- Creating table searches\nCREATE TABLE searches (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    query VARCHAR(500) NOT NULL,\n    max_results INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_searches\nBEFORE UPDATE ON searches\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n\n\n-- Creating table cart_items\nCREATE TABLE cart_items (\n    id SERIAL PRIMARY KEY,\n    user_id INT NOT NULL,\n    video_id INT NOT NULL,\n    creation_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n    FOREIGN KEY (video_id) REFERENCES videos(id) ON DELETE CASCADE\n);\n\nCREATE TRIGGER prevent_id_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_id_update();\n\nCREATE TRIGGER prevent_creation_date_update_trigger_cart_items\nBEFORE UPDATE ON cart_items\nFOR EACH ROW\nEXECUTE FUNCTION prevent_creation_date_update();\n"). Details: ERRO:  relação "users" já existe

2025-01-03 20:14:04 - INFO - Dropping database protodropdb...
2025-01-03 20:14:04 - INFO - Creating database protodropdb...
2025-01-03 20:14:05 - INFO - Database protodropdb recreated successfully.
